<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Guardian Mission</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* --- RESET & BASE --- */
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2d1b69 0%, #1a103c 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Segoe UI', 'Roboto', Helvetica, Arial, sans-serif;
            color: #333;
        }

        /* --- MAIN CONTAINER --- */
        #app-container {
            width: 100%;
            max-width: 1100px;
            aspect-ratio: 16 / 9;
            background-color: #f4f7fa;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(108, 92, 231, 0.4);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            border: 4px solid #6c5ce7;
        }

        /* --- HUD --- */
        #game-hud {
            height: 60px; /* Reduzido levemente para dar mais espaço ao conteúdo */
            background: #ffffff;
            border-bottom: 2px solid #dfe6e9;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            z-index: 100;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            flex-shrink: 0;
        }

        .hud-left { display: flex; align-items: center; gap: 20px; }
        .hud-title { font-weight: 800; color: #2d3436; text-transform: uppercase; font-size: 1rem; letter-spacing: 1px; display: flex; align-items: center; gap: 10px; }
        .hud-title i { color: #6c5ce7; font-size: 1.2rem; }

        .audio-toggle {
            background: #dfe6e9; border: none; border-radius: 20px; padding: 5px 15px;
            font-size: 0.8rem; font-weight: bold; color: #636e72; cursor: pointer;
            display: flex; align-items: center; gap: 8px; transition: all 0.2s;
        }
        .audio-toggle:hover { background: #b2bec3; }
        .audio-toggle.active { background: #00b894; color: white; }

        .shield-status { display: flex; align-items: center; gap: 15px; font-weight: bold; color: #636e72; font-size: 0.9rem; }
        .health-bar-container { width: 200px; height: 15px; background-color: #dfe6e9; border-radius: 10px; overflow: hidden; border: 2px solid #b2bec3; }
        .health-fill {
            height: 100%; width: 100%; background: linear-gradient(90deg, #00b894, #55efc4);
            transition: width 0.6s cubic-bezier(0.25, 1, 0.5, 1), background 0.3s;
            box-shadow: 0 0 10px rgba(85, 239, 196, 0.6);
        }

        /* --- SLIDES --- */
        .slide {
            flex: 1; position: relative; display: none; opacity: 0;
            transition: opacity 0.4s ease-in-out; background: #f4f7fa;
            overflow: hidden; /* Impede scrollbar interna indesejada */
        }
        .slide.active { display: flex; opacity: 1; }

        /* --- LAYOUTS --- */
        .layout-hero {
            width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 20px; position: relative;
            background: url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?auto=format&fit=crop&w=1920&q=80') no-repeat center center;
            background-size: cover;
        }
        .layout-hero::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(45, 27, 105, 0.92); z-index: 1; }
        .hero-content { position: relative; z-index: 2; color: white; max-width: 800px; width: 100%; }
        
        /* Texto padrão para slides Hero (Fundo Escuro) */
        .layout-hero h1, .layout-hero p, .hero-content h1, .hero-content p { 
            color: #f5f6fa !important; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.5); 
        }

        .layout-split { width: 100%; display: flex; height: 100%; }
        .split-visual {
            width: 40%; background-color: #e2e8f0; display: flex; flex-direction: column;
            align-items: center; justify-content: center; position: relative; overflow: hidden;
            border-right: 1px solid #cbd5e1; padding: 20px;
        }
        .split-content { width: 60%; padding: 40px 60px; display: flex; flex-direction: column; justify-content: center; overflow-y: auto; background: white; }

        /* --- TYPOGRAPHY & UI --- */
        h1 { margin-bottom: 10px; font-size: 2rem; font-weight: 900; letter-spacing: -1px; color: #2d3436;}
        h2 { color: #6c5ce7; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 15px; font-weight: 800; }
        p { font-size: 1.1rem; line-height: 1.5; color: #2d3436; margin-bottom: 20px; }
        
        .story-bubble {
            background: #f0f3ff; border-radius: 0 20px 20px 20px; padding: 20px;
            border-left: 5px solid #6c5ce7; color: #4834d4; font-weight: 500; margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.1); display: flex; gap: 15px; align-items: flex-start;
        }

        .cyber-card {
            background: white; width: 95%; border-radius: 12px; box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0; overflow: hidden; transform: rotate(-2deg); transition: transform 0.3s;
        }
        .cyber-card:hover { transform: rotate(0deg) scale(1.02); }
        .card-header { background: #6c5ce7; padding: 10px 15px; color: white; font-weight: bold; display: flex; justify-content: space-between;}
        .card-body { padding: 20px; font-size: 0.9rem; color: #333; }
        .suspicious-link { color: #0984e3; text-decoration: underline; font-weight: bold; cursor: not-allowed; }

        .btn-hero {
            background: linear-gradient(45deg, #6c5ce7, #a29bfe); color: white !important; border: none;
            padding: 14px 36px; border-radius: 50px; font-size: 1.1rem; font-weight: 700; cursor: pointer;
            transition: all 0.3s; box-shadow: 0 10px 20px rgba(108, 92, 231, 0.4); text-transform: uppercase;
            letter-spacing: 1px; text-shadow: none !important;
        }
        .btn-hero:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 15px 30px rgba(108, 92, 231, 0.5); }
        
        /* Restart Button Specific Style - Compact */
        .btn-restart {
            background: linear-gradient(45deg, #ff7675, #d63031);
            margin-top: 10px;
            font-size: 1rem;
            padding: 10px 25px;
        }
        .btn-restart:hover {
             box-shadow: 0 15px 30px rgba(214, 48, 49, 0.5);
        }

        .options-grid { display: grid; gap: 12px; }
        .option-card {
            background: white; border: 2px solid #dfe6e9; padding: 12px 18px; border-radius: 12px; cursor: pointer;
            transition: all 0.2s; display: flex; align-items: center; font-size: 0.95rem; color: #2d3436;
            font-weight: 600; position: relative; overflow: hidden;
        }
        .option-card:hover { border-color: #6c5ce7; background: #f0f3ff; transform: translateX(8px); box-shadow: 0 5px 15px rgba(108, 92, 231, 0.15); }
        .option-icon {
            width: 36px; height: 36px; background: #dfe6e9; border-radius: 8px; display: flex;
            align-items: center; justify-content: center; color: #636e72; margin-right: 15px; flex-shrink: 0; transition: all 0.2s;
        }
        .option-card:hover .option-icon { background: #6c5ce7; color: white; }

        .feedback-modal { text-align: center; animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        
        /* --- BADGE ANIMATION SYSTEM --- */
        .badge-unlock-container {
            position: relative;
            display: inline-block;
            margin: 10px 0;
        }

        .badge-sunburst {
            position: absolute;
            top: 50%; left: 50%;
            width: 250px; height: 250px;
            background: radial-gradient(circle, rgba(255,215,0,0.2) 0%, rgba(255,215,0,0) 70%);
            transform: translate(-50%, -50%);
            z-index: 0;
            animation: rotateSun 10s linear infinite;
        }
        
        @keyframes rotateSun { 
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .badge-unlock {
            position: relative;
            z-index: 1;
            background: linear-gradient(135deg, #2d3436, #000);
            color: #ffd700;
            padding: 15px 30px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 2px solid #ffd700;
            animation: bounceInBadge 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes bounceInBadge {
            0% { transform: scale(0); opacity: 0; }
            60% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        
        .badge-icon-animate {
            font-size: 3rem;
            color: #ffd700;
            filter: drop-shadow(0 0 10px rgba(255,215,0,0.5));
            animation: pulseBadge 2s infinite;
        }
        
        @keyframes pulseBadge {
            0% { transform: scale(1); filter: drop-shadow(0 0 10px rgba(255,215,0,0.5)); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 20px rgba(255,215,0,0.8)); }
            100% { transform: scale(1); filter: drop-shadow(0 0 10px rgba(255,215,0,0.5)); }
        }

        .fb-icon-large { font-size: 3rem; margin-bottom: 15px; display: inline-block; }
        .success-text { color: #55efc4 !important; } /* Lighter green for dark bg */
        .error-text { color: #ff7675 !important; }
        .warning-text { color: #ffeaa7 !important; }

        /* Badge Gallery Styles - Optimized for Layout */
        .report-panel {
            background: rgba(255,255,255,0.1);
            padding: 20px 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            max-height: 70vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .badge-gallery {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
            max-width: 100%;
        }
        .badge-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 10px;
            width: 100px; /* Compact Width */
            height: 90px;
            text-align: center;
            color: white;
            opacity: 0.4; /* Locked state */
            filter: grayscale(1);
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .badge-item.unlocked {
            opacity: 1;
            filter: grayscale(0);
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
        }
        .badge-item i { font-size: 1.8rem; margin-bottom: 5px; color: #ffd700; }
        .badge-item span { display: block; font-size: 0.65rem; font-weight: bold; text-transform: uppercase; line-height: 1.2; }

    </style>
</head>
<body>

<div id="app-container">

    <!-- HUD -->
    <div id="game-hud">
        <div class="hud-left">
            <div class="hud-title"><i class="fas fa-shield-virus"></i> CYBER GUARDIAN</div>
            <button class="audio-toggle" id="btn-audio" onclick="toggleAudio()"><i class="fas fa-volume-mute"></i> SOUND OFF</button>
        </div>
        <div class="shield-status">
            <span>SHIELD INTEGRITY:</span>
            <div class="health-bar-container"><div class="health-fill" id="shield-bar"></div></div>
            <span id="shield-text">100%</span>
        </div>
    </div>

    <!-- SLIDE 01: HERO INTRO -->
    <div class="slide active" id="slide-01">
        <div class="layout-hero">
            <div class="hero-content">
                <i class="fas fa-user-secret" style="font-size: 4rem; margin-bottom: 15px; color: #a29bfe;"></i>
                <h1>Mission: Protect the Network</h1>
                <p>You start with <strong>100% Shield Integrity</strong>. Every security risk you neutralize keeps the shield up.</p>
                <p style="font-size: 1rem; color: #fab1a0 !important; margin-bottom: 25px;">WARNING: Mistakes cause damage. Don't let the shield drop below 50%.</p>
                <button class="btn-hero" onclick="enableAudioAndStart()">INITIALIZE MISSION</button>
            </div>
        </div>
    </div>

    <!-- SLIDE 02: BRIEFING -->
    <div class="slide" id="slide-02">
        <div class="layout-split">
            <div class="split-visual" style="background: #f0f3ff;">
                <i class="fas fa-shield-alt" style="font-size: 8rem; color: #a29bfe; text-shadow: 0 10px 20px rgba(0,0,0,0.1);"></i>
            </div>
            <div class="split-content">
                <h2>Mission Briefing</h2>
                <h1>Protocol Initiated</h1>
                <div class="story-bubble">
                    <i class="fas fa-terminal" style="margin-top: 5px;"></i>
                    <div>
                        "System Status: ONLINE. Agent, you will face threats including Phishing, Data Leaks, Visual Hacking, Wi-Fi Security, Password Hygiene, and Social Engineering. Good luck."
                    </div>
                </div>
                <button class="btn-hero" style="font-size: 1rem; padding: 12px 30px;" onclick="goToSlide('slide-03')">Start Patrol <i class="fas fa-arrow-right"></i></button>
            </div>
        </div>
    </div>

    <!-- SLIDE 03: CHALLENGE 1 (Phishing) -->
    <div class="slide" id="slide-03">
        <div class="layout-split">
            <div class="split-visual">
                <h3 style="color:#636e72; margin-bottom: 20px;">INCOMING TRANSMISSION</h3>
                <div class="cyber-card">
                    <div class="card-header"><span><i class="fas fa-envelope"></i> MAIL.EXE</span><span><i class="fas fa-exclamation-triangle" style="color: #fdcb6e;"></i> SPAM?</span></div>
                    <div class="card-body">
                        <strong>From:</strong> Admin (admin@<span style="color:#d63031; background:#fab1a0;">mail-security.net</span>)<br><br>
                        <strong>Subject:</strong> URGENT: PASSWORD EXPIRY<br>
                        <span class="suspicious-link">Click here to verify immediately</span> or lose access.
                    </div>
                </div>
            </div>
            <div class="split-content">
                <h2>Threat Detected: Level 1</h2>
                <h1>The Phishing Hook</h1>
                <p>Suspicious email detected. Sender domain is unverified. How do you proceed?</p>
                <div class="options-grid">
                    <div class="option-card" onclick="handleDecision('03', 'A')"><div class="option-icon"><i class="fas fa-mouse-pointer"></i></div><div>Click link to verify.</div></div>
                    <div class="option-card" onclick="handleDecision('03', 'B')"><div class="option-icon"><i class="fas fa-trash-alt"></i></div><div>Delete immediately.</div></div>
                    <div class="option-card" onclick="handleDecision('03', 'C')"><div class="option-icon"><i class="fas fa-shield-alt"></i></div><div>Report via Protocol.</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- FEEDBACK SLIDE: SUCCESS (DARK THEME RESTORED) -->
    <div class="slide" id="slide-feedback-success">
        <!-- Removed inline style background: white to use default hero dark theme -->
        <div class="layout-hero">
            <div class="hero-content">
                <div class="feedback-modal">
                    
                    <!-- Feedback Title & Msg -->
                    <i class="fas fa-check-circle fb-icon-large success-text" id="fb-icon-default"></i>
                    <!-- Colors updated for dark background contrast -->
                    <h1 class="success-text" id="fb-success-title">Well Done</h1>
                    <p id="fb-success-msg" style="color: #f5f6fa !important;">...</p>
                    
                    <!-- DYNAMIC BADGE CONTAINER -->
                    <div id="badge-popup" style="display: none;">
                        <div class="badge-unlock-container">
                            <div class="badge-sunburst"></div>
                            <div class="badge-unlock">
                                <i class="fas fa-medal badge-icon-animate"></i>
                                <div style="text-align: center;">
                                    <div style="font-size: 0.8rem; opacity: 0.9; color: #fff; letter-spacing: 2px;">ACHIEVEMENT UNLOCKED</div>
                                    <div id="badge-name" style="font-weight: 900; font-size: 1.2rem; color: #ffd700; margin-top: 5px;">BADGE NAME</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn-hero" onclick="nextSlideFromFeedback()">Next Sector <i class="fas fa-forward"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FEEDBACK SLIDE: FAILURE -->
    <div class="slide" id="slide-feedback-fail">
        <div class="layout-hero" style="background: #2d3436;">
            <div class="hero-content">
                <div class="feedback-modal">
                    <i class="fas fa-radiation-alt fb-icon-large error-text"></i>
                    <h1 class="error-text" id="fb-fail-title">Shields Damaged!</h1>
                    <p id="fb-fail-msg">...</p>
                    <button class="btn-hero" style="background: #ff7675;" onclick="nextSlideFromFeedback()">Emergency Reroute <i class="fas fa-forward"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 05: CHALLENGE 2 (Data Leak) -->
    <div class="slide" id="slide-05">
        <div class="layout-split">
            <div class="split-visual">
                <i class="fas fa-file-contract" style="font-size: 5rem; color: #a29bfe; margin-bottom: 20px;"></i>
                <div style="background: white; padding: 10px 20px; border-radius: 20px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.1);"><i class="fas fa-lock"></i> ENCRYPTED?</div>
            </div>
            <div class="split-content">
                <h2>Threat Detected: Level 2</h2>
                <h1>Data Extraction</h1>
                <p>Transfer 'Project Omega' financials to Marketing. Choose transfer method.</p>
                <div class="options-grid">
                    <div class="option-card" onclick="handleDecision('05', 'A')"><div class="option-icon"><i class="fab fa-google-drive"></i></div><div>Public Team Drive.</div></div>
                    <div class="option-card" onclick="handleDecision('05', 'B')"><div class="option-icon"><i class="fas fa-envelope-open"></i></div><div>Personal Gmail.</div></div>
                    <div class="option-card" onclick="handleDecision('05', 'C')"><div class="option-icon"><i class="fas fa-key"></i></div><div>Encrypted Vault.</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 07: CHALLENGE 3 (Visual Hacking) -->
    <div class="slide" id="slide-07">
        <div class="layout-split">
            <div class="split-visual">
                <img src="https://images.unsplash.com/photo-1497215728101-856f4ea42174?auto=format&fit=crop&w=600&q=80" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.8;" alt="Office">
                <div style="position: absolute; top: 20px; left: 20px; background: #d63031; color: white; padding: 5px 10px; font-weight: bold; border-radius: 5px;"><i class="fas fa-eye"></i> VISITOR</div>
            </div>
            <div class="split-content">
                <h2>Threat Detected: Level 3</h2>
                <h1>Visual Hackers</h1>
                <p>You are coding in the lounge. An unknown visitor is walking behind you.</p>
                <div class="options-grid">
                    <div class="option-card" onclick="handleDecision('07', 'A')"><div class="option-icon"><i class="fas fa-desktop"></i></div><div>Lock Screen (Win + L).</div></div>
                    <div class="option-card" onclick="handleDecision('07', 'B')"><div class="option-icon"><i class="fas fa-hand-paper"></i></div><div>Block with body.</div></div>
                    <div class="option-card" onclick="handleDecision('07', 'C')"><div class="option-icon"><i class="fas fa-coffee"></i></div><div>Ignore them.</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 09: CHALLENGE 4 (Wi-Fi) -->
    <div class="slide" id="slide-09">
        <div class="layout-split">
            <div class="split-visual">
                <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?auto=format&fit=crop&w=600&q=80" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.8;" alt="Cafe">
                <div style="position: absolute; top: 20px; left: 20px; background: #fdcb6e; color: white; padding: 5px 10px; font-weight: bold; border-radius: 5px;"><i class="fas fa-wifi"></i> UNSECURED</div>
            </div>
            <div class="split-content">
                <h2>Threat Detected: Level 4</h2>
                <h1>Remote Connection</h1>
                <p>You are at a coffee shop and need to upload a contract. Available networks found.</p>
                <div class="options-grid">
                    <div class="option-card" onclick="handleDecision('09', 'A')"><div class="option-icon"><i class="fas fa-mug-hot"></i></div><div>Connect to "Cafe_Free_WiFi".</div></div>
                    <div class="option-card" onclick="handleDecision('09', 'B')"><div class="option-icon"><i class="fas fa-mobile-alt"></i></div><div>Use Personal Hotspot.</div></div>
                    <div class="option-card" onclick="handleDecision('09', 'C')"><div class="option-icon"><i class="fas fa-user-secret"></i></div><div>Use Company VPN + WiFi.</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 11: CHALLENGE 5 (Password) -->
    <div class="slide" id="slide-11">
        <div class="layout-split">
            <div class="split-visual" style="background: #2d3436; color: white; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                <i class="fas fa-key" style="font-size: 5rem; margin-bottom: 20px; color: #fdcb6e;"></i>
                <h3>CHANGE PASSWORD</h3>
            </div>
            <div class="split-content">
                <h2>Threat Detected: Level 5</h2>
                <h1>Credentials</h1>
                <p>Your password has expired. Choose a new, secure password.</p>
                <div class="options-grid">
                    <div class="option-card" onclick="handleDecision('11', 'A')"><div class="option-icon"><i class="fas fa-cat"></i></div><div>"Fluffy2024" (Pet's name).</div></div>
                    <div class="option-card" onclick="handleDecision('11', 'B')"><div class="option-icon"><i class="fas fa-sync"></i></div><div>Reuse old password with a '1'.</div></div>
                    <div class="option-card" onclick="handleDecision('11', 'C')"><div class="option-icon"><i class="fas fa-fingerprint"></i></div><div>Passphrase: "Blue!Sky$Walk77".</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 13: CHALLENGE 6 (Social Engineering) -->
    <div class="slide" id="slide-13">
        <div class="layout-split">
            <div class="split-visual">
                <i class="fas fa-phone-volume" style="font-size: 5rem; color: #ff7675; animation: shake 0.5s infinite;"></i>
                <h3 style="color: #2d3436; margin-top: 20px;">CALLER ID: UNKNOWN</h3>
            </div>
            <div class="split-content">
                <h2>Threat Detected: Level 6</h2>
                <h1>Vishing Attack</h1>
                <p>Caller claims to be "IT Director". Says your account is flagged and demands your 2FA code immediately.</p>
                <div class="options-grid">
                    <div class="option-card" onclick="handleDecision('13', 'A')"><div class="option-icon"><i class="fas fa-check"></i></div><div>Give the code to help.</div></div>
                    <div class="option-card" onclick="handleDecision('13', 'B')"><div class="option-icon"><i class="fas fa-phone-slash"></i></div><div>Hang up and call IT Support.</div></div>
                    <div class="option-card" onclick="handleDecision('13', 'C')"><div class="option-icon"><i class="fas fa-question"></i></div><div>Argue with them.</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE REPORT: FINAL -->
    <div class="slide" id="slide-report">
        <div class="layout-hero">
            <div class="hero-content">
                
                <div class="report-panel">
                    <i class="fas fa-clipboard-check" style="font-size: 3rem; margin-bottom: 10px; color: #fab1a0;"></i>
                    <h1 style="font-size: 1.8rem; margin-bottom: 5px;">Mission Report</h1>
                    
                    <h2 style="color: white; font-size: 1.2rem;" id="final-grade">CALCULATING...</h2>
                    <p id="final-message" style="font-size: 0.9rem; margin-bottom: 10px;">Reviewing integrity logs...</p>
                    
                    <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 10px 0; width: 100%;">
                    <h3 style="color: #dfe6e9; font-size: 0.8rem;">MEDALS AWARDED</h3>
                    
                    <!-- BADGE GALLERY (COMPACT FOR VISIBILITY) -->
                    <div class="badge-gallery">
                        <div class="badge-item" id="badge-detective">
                            <i class="fas fa-user-secret"></i>
                            <span>Cyber Detective</span>
                        </div>
                        <div class="badge-item" id="badge-data">
                            <i class="fas fa-database"></i>
                            <span>Data Keeper</span>
                        </div>
                        <div class="badge-item" id="badge-privacy">
                            <i class="fas fa-eye-slash"></i>
                            <span>Privacy Guardian</span>
                        </div>
                        <div class="badge-item" id="badge-wifi">
                            <i class="fas fa-wifi"></i>
                            <span>Secure Surfer</span>
                        </div>
                        <div class="badge-item" id="badge-cipher">
                            <i class="fas fa-key"></i>
                            <span>Cipher Master</span>
                        </div>
                        <div class="badge-item" id="badge-firewall">
                            <i class="fas fa-user-shield"></i>
                            <span>Human Firewall</span>
                        </div>
                    </div>

                    <button class="btn-hero btn-restart" onclick="location.reload()">
                        <i class="fas fa-power-off"></i> SYSTEM REBOOT
                    </button>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    // --- STATE ---
    let shieldIntegrity = 100;
    let audioEnabled = false;
    let currentLevel = ''; 
    let earnedBadges = []; // Store IDs of badges earned

    // --- BADGE DEFINITIONS (ALL 6 LEVELS) ---
    const badgeDefs = {
        '03': { id: 'badge-detective', name: 'CYBER DETECTIVE' },
        '05': { id: 'badge-data', name: 'DATA KEEPER' },
        '07': { id: 'badge-privacy', name: 'PRIVACY GUARDIAN' },
        '09': { id: 'badge-wifi', name: 'SECURE SURFER' },
        '11': { id: 'badge-cipher', name: 'CIPHER MASTER' },
        '13': { id: 'badge-firewall', name: 'HUMAN FIREWALL' }
    };
    
    // --- FEEDBACK DATABASE ---
    const feedbackData = {
        '03': {
            'A': { damage: 35, title: "Malware Installed", msg: "Clicking unverified links executes scripts instantly. Always check the URL domain first." },
            'B': { damage: 10, title: "Threat Ignored", msg: "Deleting protects you, but not your team. The attacker will just email your colleague next." },
            'C': { damage: 0, title: "Threat Blocked", msg: "Reporting allows IT to block this sender domain-wide, protecting the entire company." }
        },
        '05': {
            'A': { damage: 20, title: "Permissions Error", msg: "Public shared drives often have lax permissions. Anyone with the link could access financial data." },
            'B': { damage: 35, title: "Data Exfiltrated", msg: "Personal accounts lack corporate encryption and audit logs. If hacked, client data is exposed." },
            'C': { damage: 0, title: "Secure Transfer", msg: "Encrypted vaults ensure only the intended recipient with the correct key can access the files." }
        },
        '07': {
            'A': { damage: 0, title: "Screen Secure", msg: "Locking your workstation (Win+L) is the only 100% effective way to prevent visual snooping." },
            'B': { damage: 20, title: "Partial Exposure", msg: "Your body cannot cover the entire screen. Side angles still reveal code to the visitor." },
            'C': { damage: 35, title: "Credentials Stolen", msg: "The visitor photographed your screen. Never code sensitive logic in public view." }
        },
        '09': {
            'A': { damage: 35, title: "Man-in-the-Middle", msg: "Public Wi-Fi is often unencrypted. Hackers can intercept everything you upload." },
            'B': { damage: 0, title: "Private Connection", msg: "Using your own hotspot isolates you from the public network risk. Good choice." },
            'C': { damage: 0, title: "Encrypted Tunnel", msg: "VPNs encrypt your traffic, making it unreadable to anyone snooping on the network." }
        },
        '11': {
            'A': { damage: 35, title: "Brute Forced", msg: "Pet names are easily found on social media. This password would be cracked in seconds." },
            'B': { damage: 20, title: "Domino Effect", msg: "Reusing passwords means if one site is breached, your work account is also compromised." },
            'C': { damage: 0, title: "High Entropy", msg: "Long passphrases are mathematically difficult to crack but easy for humans to remember." }
        },
        '13': {
            'A': { damage: 50, title: "Account Takeover", msg: "IT Support will NEVER ask for your password or 2FA code. You just handed over your account." },
            'B': { damage: 0, title: "Attack Thwarted", msg: "Verifying identity by calling the official internal number is the only safe procedure." },
            'C': { damage: 20, title: "Information Leak", msg: "Arguing gives the attacker voice samples and confirms your shift hours. Just hang up." }
        }
    };

    // --- NARRATION ---
    const narrations = {
        'slide-01': "Mission: Protect the Network. You start with 100% Shield Integrity. Every security risk you neutralize keeps the shield up. Warning: Mistakes cause damage.",
        'slide-02': "System Status: ONLINE. Agent, you will face threats including Phishing, Data Leaks, Visual Hacking, Wi-Fi Security, Password Hygiene, and Social Engineering.",
        'slide-03': "Threat Detected: Level 1. Phishing. Suspicious email detected. Sender domain is unverified. How do you proceed?",
        'slide-05': "Threat Detected: Level 2. Data Extraction. Transfer Project Omega financials. Choose transfer method.",
        'slide-07': "Threat Detected: Level 3. Visual Hacking. Unknown visitor is walking behind you while you code.",
        'slide-09': "Threat Detected: Level 4. Remote Connection. You are at a coffee shop. How do you connect to the internet safely?",
        'slide-11': "Threat Detected: Level 5. Credentials. Your password has expired. Choose a secure replacement.",
        'slide-13': "Threat Detected: Level 6. Vishing Attack. Caller claims to be IT Director demanding your access code.",
        'slide-report': "Mission Complete. Generating final report."
    };

    function toggleAudio() {
        audioEnabled = !audioEnabled;
        const btn = document.getElementById('btn-audio');
        if(audioEnabled) {
            btn.innerHTML = '<i class="fas fa-volume-up"></i> SOUND ON'; btn.classList.add('active');
            const currentSlide = document.querySelector('.slide.active');
            if(currentSlide && narrations[currentSlide.id]) playText(narrations[currentSlide.id]);
        } else {
            btn.innerHTML = '<i class="fas fa-volume-mute"></i> SOUND OFF'; btn.classList.remove('active');
            window.speechSynthesis.cancel();
        }
    }

    function enableAudioAndStart() {
        audioEnabled = true;
        const btn = document.getElementById('btn-audio');
        btn.innerHTML = '<i class="fas fa-volume-up"></i> SOUND ON'; btn.classList.add('active');
        goToSlide('slide-02');
    }

    function playText(text) {
        window.speechSynthesis.cancel();
        if(!audioEnabled || !text) return;
        const msg = new SpeechSynthesisUtterance();
        msg.text = text;
        msg.lang = 'en-US';
        window.speechSynthesis.speak(msg);
    }

    // --- NAVIGATION ---
    function goToSlide(slideId) {
        document.querySelectorAll('.slide').forEach(s => {
            s.classList.remove('active'); s.style.opacity = 0;
            setTimeout(() => { if(!s.classList.contains('active')) s.style.display = 'none'; }, 400);
        });
        const target = document.getElementById(slideId);
        target.style.display = 'flex';
        
        if(narrations[slideId]) playText(narrations[slideId]);
        setTimeout(() => { target.classList.add('active'); target.style.opacity = 1; }, 50);
    }

    function nextSlideFromFeedback() {
        if(currentLevel === '03') goToSlide('slide-05');
        else if(currentLevel === '05') goToSlide('slide-07');
        else if(currentLevel === '07') goToSlide('slide-09');
        else if(currentLevel === '09') goToSlide('slide-11');
        else if(currentLevel === '11') goToSlide('slide-13');
        else if(currentLevel === '13') generateReport();
    }

    // --- GAMEPLAY LOGIC ---
    function handleDecision(level, choice) {
        currentLevel = level;
        const data = feedbackData[level][choice];
        const popup = document.getElementById('badge-popup');
        const defaultIcon = document.getElementById('fb-icon-default');
        
        // Default Hide Popup & Show Standard Icon
        popup.style.display = 'none';
        defaultIcon.style.display = 'inline-block';

        // Check Logic
        let feedbackSlide = '';
        if (data.damage === 0) {
            feedbackSlide = 'slide-feedback-success';
            document.getElementById('fb-success-title').innerText = data.title;
            document.getElementById('fb-success-msg').innerText = data.msg;

            // BADGE CHECK (Now checks ALL levels)
            if (badgeDefs[level]) {
                const badgeInfo = badgeDefs[level];
                // Show Badge, Hide Default Icon
                popup.style.display = 'block';
                defaultIcon.style.display = 'none';
                
                document.getElementById('badge-name').innerText = badgeInfo.name;
                
                if(!earnedBadges.includes(badgeInfo.id)) earnedBadges.push(badgeInfo.id);
                
                // Play special audio
                updateShield(data.damage);
                goToSlide(feedbackSlide);
                playText("Achievement Unlocked: " + badgeInfo.name + ". " + data.msg);
                return;
            }

        } else {
            feedbackSlide = 'slide-feedback-fail';
            document.getElementById('fb-fail-title').innerText = data.title;
            document.getElementById('fb-fail-msg').innerText = data.msg;
        }

        updateShield(data.damage);
        goToSlide(feedbackSlide);
        playText(data.title + ". " + data.msg);
    }

    function updateShield(damage) {
        shieldIntegrity -= damage;
        if(shieldIntegrity < 0) shieldIntegrity = 0;
        const bar = document.getElementById('shield-bar');
        const text = document.getElementById('shield-text');
        bar.style.width = shieldIntegrity + '%';
        text.innerText = shieldIntegrity + '%';
        if(shieldIntegrity < 50) {
            bar.style.background = 'linear-gradient(90deg, #ff7675, #d63031)';
            bar.style.boxShadow = '0 0 15px rgba(214, 48, 49, 0.7)';
        }
    }

    function generateReport() {
        goToSlide('slide-report');
        const gradeEl = document.getElementById('final-grade');
        const msgEl = document.getElementById('final-message');
        
        if(shieldIntegrity >= 80) {
            gradeEl.innerText = "GRADE: S (ELITE)"; gradeEl.style.color = "#55efc4";
            msgEl.innerText = "Outstanding performance. Mainframe secure.";
        } else if (shieldIntegrity >= 50) {
            gradeEl.innerText = "GRADE: B (PASSED)"; gradeEl.style.color = "#ffeaa7";
            msgEl.innerText = "Mission accomplished. Review protocols.";
        } else {
            gradeEl.innerText = "GRADE: F (FAILED)"; gradeEl.style.color = "#ff7675";
            msgEl.innerText = "Critical failure. Retraining required.";
        }

        // UNLOCK BADGES IN GALLERY
        earnedBadges.forEach(badgeId => {
            const badgeEl = document.getElementById(badgeId);
            if(badgeEl) badgeEl.classList.add('unlocked');
        });
        
        if(narrations['slide-report']) playText(narrations['slide-report']);
    }
</script>

</body>
</html>